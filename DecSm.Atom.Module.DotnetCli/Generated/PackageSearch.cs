// <auto-generated/>

#nullable enable

using DecSm.Atom.Paths;
using DecSm.Atom.Process;
using JetBrains.Annotations;

namespace DecSm.Atom.Module.DotnetCli;

public partial interface IDotnetCli
{
    /// <summary>
    ///     Searches one or more package sources for packages that match a search term. If no sources are specified, all sources defined in the NuGet.Config are used.
    /// </summary>
    /// <param name="searchTerm">
    ///     Search term to filter package names, descriptions, and tags. Used as a literal value. Example: `dotnet package search some.package`. See also `--exact-match`.
    /// </param>
    /// <param name="options">
    ///     Options
    /// </param>
    /// <param name="cancellationToken">
    ///     Cancellation token
    /// </param>
    public Task<ProcessRunResult> PackageSearch(
        System.String searchTerm,
        PackageSearchOptions? options = null,
        CancellationToken cancellationToken = default
    );
    
}

internal partial class DotnetCli : IDotnetCli
{
    public Task<ProcessRunResult> PackageSearch(
        System.String searchTerm,
        PackageSearchOptions? options = null,
        CancellationToken cancellationToken = default
    ) =>
        processRunner.RunAsync(new("dotnet",
            string.Join(' ', [
                "package search",
                searchTerm,
                options?.ToString(),
            ])), cancellationToken);
    
}

[PublicAPI]
public sealed record PackageSearchOptions
{
    /// <summary>
    ///     The NuGet configuration file. If specified, only the settings from this file will be used. If not specified, the hierarchy of configuration files from the current directory will be used. For more information, see https://docs.microsoft.com/nuget/consume-packages/configuring-nuget-behavior
    /// </summary>
    public System.String? Configfile
    {
        get;
        init;
    }
    
    /// <summary>
    ///     Require that the search term exactly match the name of the package. Causes `--take` and `--skip` options to be ignored.
    /// </summary>
    public System.Boolean? ExactMatch
    {
        get;
        init;
    }
    
    /// <summary>
    ///     Format the output accordingly. Either `table`, or `json`. The default value is `table`.
    /// </summary>
    public System.String? Format
    {
        get;
        init;
    }
    
    /// <summary>
    ///     Allows the command to stop and wait for user input or action (for example to complete authentication).
    /// </summary>
    public System.Boolean? Interactive
    {
        get;
        init;
    }
    
    /// <summary>
    ///     Include prerelease packages.
    /// </summary>
    public System.Boolean? Prerelease
    {
        get;
        init;
    }
    
    /// <summary>
    ///     Number of results to skip, to allow pagination. Default 0.
    /// </summary>
    public System.String? Skip
    {
        get;
        init;
    }
    
    /// <summary>
    ///     The package source to search. You can pass multiple `--source` options to search multiple package sources. Example: `--source https://api.nuget.org/v3/index.json`.
    /// </summary>
    public string? Source
    {
        get;
        init;
    }
    
    /// <summary>
    ///     Number of results to return. Default 20.
    /// </summary>
    public System.String? Take
    {
        get;
        init;
    }
    
    /// <summary>
    ///     Display this amount of details in the output: `normal`, `minimal`, `detailed`. The default is `normal`
    /// </summary>
    public System.String? Verbosity
    {
        get;
        init;
    }
    
    public override string ToString()    {
        return string.Join(' ',
        new[]
        {
            Configfile is not null
                ? $"--configfile {Configfile}"
                : null,
            ExactMatch is true
                ? "--exact-match"
                : null,
            Format is not null
                ? $"--format {Format}"
                : null,
            Interactive is true
                ? "--interactive"
                : null,
            Prerelease is true
                ? "--prerelease"
                : null,
            Skip is not null
                ? $"--skip {Skip}"
                : null,
            Source is not null
                ? $"--source {Source}"
                : null,
            Take is not null
                ? $"--take {Take}"
                : null,
            Verbosity is not null
                ? $"--verbosity {Verbosity}"
                : null,
        }
        );
    }
    
}

