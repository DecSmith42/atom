namespace DecSm.Atom.Build.Model;

/// <summary>
///     Represents a target within the build model, defining its tasks, dependencies, inputs, and outputs.
/// </summary>
/// <remarks>
///     This model is generated by Atom on startup and is immutable by design.
/// </remarks>
/// <param name="Name">The name of the target.</param>
/// <param name="Description">An optional description of the target.</param>
/// <param name="IsHidden">A value indicating whether the target should be hidden from user-facing lists.</param>
[PublicAPI]
public sealed record TargetModel(string Name, string? Description, bool IsHidden)
{
    /// <summary>
    ///     Gets the collection of asynchronous tasks that will be executed when the target runs.
    /// </summary>
    public required IReadOnlyList<Func<CancellationToken, Task>> Tasks { get; init; }

    /// <summary>
    ///     Gets the parameters that are used by this target.
    /// </summary>
    public required IReadOnlyList<UsedParam> Params { get; init; }

    /// <summary>
    ///     Gets the artifacts that are consumed by this target.
    /// </summary>
    /// <seealso cref="TargetDefinition.ConsumedArtifacts" />
    public required IReadOnlyList<ConsumedArtifact> ConsumedArtifacts { get; init; }

    /// <summary>
    ///     Gets the artifacts that are produced by this target.
    /// </summary>
    /// <seealso cref="TargetDefinition.ProducedArtifacts" />
    public required IReadOnlyList<ProducedArtifact> ProducedArtifacts { get; init; }

    /// <summary>
    ///     Gets the variables that are consumed by this target.
    /// </summary>
    /// <seealso cref="TargetDefinition.ConsumedVariables" />
    public required IReadOnlyList<ConsumedVariable> ConsumedVariables { get; init; }

    /// <summary>
    ///     Gets the variables that are produced by this target.
    /// </summary>
    /// <seealso cref="TargetDefinition.ProducedVariables" />
    public required IReadOnlyList<string> ProducedVariables { get; init; }

    /// <summary>
    ///     Gets the targets that must be executed before this target.
    /// </summary>
    public required IReadOnlyList<TargetModel> Dependencies { get; init; }

    /// <summary>
    ///     Gets the assembly in which this target was declared.
    /// </summary>
    public required Assembly DeclaringAssembly { get; init; }
}
