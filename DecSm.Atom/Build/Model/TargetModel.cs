namespace DecSm.Atom.Build.Model;

/// <summary>
///     Represents a target within the build model, defining tasks, dependencies, inputs, and outputs.
///     Generated by Atom on startup, immutable by design.
/// </summary>
/// <param name="Name">The name of the target.</param>
/// <param name="Description">The descriptive information about the target. Optional.</param>
/// <param name="IsHidden">Indicates if the target should be hidden in user-facing lists or outputs.</param>
[PublicAPI]
public sealed record TargetModel(string Name, string? Description, bool IsHidden)
{
    /// <summary>
    ///     The actual code that will be executed when the target is run.
    /// </summary>
    public required IReadOnlyList<Func<CancellationToken, Task>> Tasks { get; init; }

    /// <summary>
    ///     Represents the input parameters that are mandatory for the execution of the target.
    /// </summary>
    public required IReadOnlyList<ParamModel> RequiredParams { get; init; }

    /// <summary>
    ///     Artifacts that are consumed by the target during the build process.
    ///     <seealso cref="TargetDefinition.ConsumedArtifacts" />
    /// </summary>
    public required IReadOnlyList<ConsumedArtifact> ConsumedArtifacts { get; init; }

    /// <summary>
    ///     The artifacts that are generated as a result of executing the target.
    ///     <seealso cref="TargetDefinition.ProducedArtifacts" />
    /// </summary>
    public required IReadOnlyList<ProducedArtifact> ProducedArtifacts { get; init; }

    /// <summary>
    ///     The variables that are consumed by the target during the build process.
    ///     <seealso cref="TargetDefinition.ConsumedVariables" />
    /// </summary>
    public required IReadOnlyList<ConsumedVariable> ConsumedVariables { get; init; }

    /// <summary>
    ///     The variables that are generated as a result of executing the target.
    ///     <seealso cref="TargetDefinition.ProducedVariables" />
    /// </summary>
    public required IReadOnlyList<string> ProducedVariables { get; init; }

    /// <summary>
    ///     Targets that will be executed before this target.
    /// </summary>
    public required IReadOnlyList<TargetModel> Dependencies { get; init; }

    /// <summary>
    ///     The assembly that declared this target.
    /// </summary>
    public required Assembly DeclaringAssembly { get; init; }
}
